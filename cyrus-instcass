#!/bin/bash
set -e
set -o pipefail

test -z "$CASS_ROOTDIR" &&
    echo "please set CASS_ROOTDIR and CYRUS_PREFIX to match your cassandane.ini" 1>&2 &&
    exit 1

# cass directory doesn't necessarily persist, so make sure it's there
test -d "$CASS_ROOTDIR" || sudo -u cyrus mkdir "$CASS_ROOTDIR"

test -d "$CYRUS_PREFIX" && rm -fr "$CYRUS_PREFIX"
make install
